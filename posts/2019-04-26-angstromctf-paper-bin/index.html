<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>AngstromCTF2019: Paper Bin</title>
    <meta property="og:title" content="AngstromCTF2019: Paper Bin" />
    <meta name="twitter:title" content="AngstromCTF2019: Paper Bin" /><meta name="description" content="Hexeditors can be very useful">
    <meta property="og:description" content="Hexeditors can be very useful">
    <meta name="twitter:description" content="Hexeditors can be very useful"><meta name="author" content="Morgaine Timms"/>
    <link href='/favicon.ico' rel='icon' type='image/x-icon'/>

    <meta property="og:url" content="/posts/2019-04-26-angstromctf-paper-bin/" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="TimmsIO" />
    <link rel="canonical" href="/posts/2019-04-26-angstromctf-paper-bin/" />

    
    <link rel="stylesheet" 
    href="/style.main.min.e7f371a858bb69f9a56c8256391f85bc992f05f4db9e9c4cd9773ae8465c7504.css" 
    integrity="sha256-5/NxqFi7afmlbIJWOR&#43;FvJkvBfTbnpxM2Xc66EZcdQQ=" 
    media="screen">
</head> 


<body><nav id="primary-nav" class="navbar is-black" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item" href=""><img src="/logo.svg" alt=" TimmsIO" /></a>
            <div role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
                data-target="navbarMenu">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </div>
        </div>
        <div class="navbar-menu" id="navbarMenu">
            <div class="navbar-start"></div>
            <div class="navbar-end"><a class="navbar-item" title="About" href="/#contact">About</a><div class="navbar-item has-dropdown">
                    <a class="navbar-link" title="Posts" >Posts</a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" title="Blog"
                            href="/categories/blog/">Blog</a>
                        
                        <a class="navbar-item" title="Writeups"
                            href="/categories/writeups/">Writeups</a>
                        
                        <a class="navbar-item" title="CTFs"
                            href="/categories/ctfs">CTFs</a>
                        <hr class="navbar-divider">
                        <a class="navbar-item" title="All"
                            href="/posts">All</a>
                        </div>
                </div><a class="navbar-item" title="Projects" href="/projects">Projects</a></div>
        </div>
    </div>
</nav><div class="page-blocks"></div>
    
    
    <section class="hero is-medium"style="background-image: url(/image/Angstrom_Unit.jpg)">
    <div class="container hero-body has-text-centered" style="text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;"><h1 class="title is-1 has-text-white">AngstromCTF2019: Paper Bin</h1>
    </div>
</section>

    
    <div class="columns is-gapless is-desktop">
            
        <div class="column">
            

<section class='section container content'>
    <div class="tio-page columns is-centered">
        <div class="column is-four-fifths-tablet is-three-quarters-widescreen has-background-dark has-text-light">
            
            <h1 id="angstromctf2019-paper-bin">AngstromCTF2019: Paper Bin</h1>

<h2 id="the-challenge">The Challenge</h2>

<blockquote>
<p>Paper Bin
Misc
40 pts</p>

<p>defund accidentally deleted all of his math papers! Help recover them from his computer&rsquo;s raw data.</p>

<p>Author: defund</p>

<p>link: <a href="https://files.actf.co/ac4e8f7e16fb244613ffe42741046f98839e477e7a511d583dcc1bb291486029/paper_bin.dat">https://files.actf.co/ac4e8f7e16fb244613ffe42741046f98839e477e7a511d583dcc1bb291486029/paper_bin.dat</a></p>
</blockquote>

<h2 id="the-solution">The Solution</h2>

<p>This was a frustrating challenge simply because most tools designed to deal with PDFs happily read through the first PDF in the binary and report that is all there was.
Interestingly, different PDF readers would pick different PDFs from the file to display — but all would only display one PDF.</p>

<p>After inspecting the output from the excellent <a href="https://blog.didierstevens.com/2008/10/30/pdf-parserpy/">pdf-parser.py by Didier Stevens</a> and deciding to use a hex editor, the PDFs in the .dat became clearer.</p>

<p>Searching for the PDF file header “%PDF” in the .dat file revealed the files. One of them appears to have a different version.</p>

<p><img src="/assets/posts/angstromctf2019/6ED266953DEB27B53066DE71DEE358E9.png" alt="" /></p>

<p>Carving the PDFs out of the file and opening the suspicious one revealed the flag.</p>

<p><img src="/assets/posts/angstromctf2019/4713E54D36B8B377AF339BEA4687FA3E.png" alt="" /></p>

        </div>
    </div>
</section>


        </div>
    </div>
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">



<noscript>
    <style>.navbar-burger-toggle+.navbar-burger{margin-top:-3.5em}.navbar-burger-toggle:checked+.navbar-burger span:nth-child(1){transform:translateY(5px) rotate(45deg)}.navbar-burger-toggle:checked+.navbar-burger span:nth-child(2){opacity:0}.navbar-burger-toggle:checked+.navbar-burger span:nth-child(3){transform:translateY(-5px) rotate(-45deg)}.navbar-burger-toggle:checked~.navbar-menu{display:block}
    </style>
</noscript>
<script>
        'use strict';document.addEventListener('DOMContentLoaded',function(){var $dropdowns=getAll('.navbar-item.has-dropdown:not(.is-hoverable)');if($dropdowns.length>0){$dropdowns.forEach(function($el){$el.addEventListener('click',function(event){event.stopPropagation();$el.classList.toggle('is-active');});});document.addEventListener('click',function(event){closeDropdowns();});}
function closeDropdowns(){$dropdowns.forEach(function($el){$el.classList.remove('is-active');});}
document.addEventListener('keydown',function(event){var e=event||window.event;if(e.keyCode===27){closeDropdowns();}});var $burgers=getAll('.burger');if($burgers.length>0){$burgers.forEach(function($el){$el.addEventListener('click',function(){var target=$el.dataset.target;var $target=document.getElementById(target);$el.classList.toggle('is-active');$target.classList.toggle('is-active');});});}
function getAll(selector){return Array.prototype.slice.call(document.querySelectorAll(selector),0);}});
</script>
</body>

</html>